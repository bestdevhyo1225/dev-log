# Publish / Subscribe

## Pub/Sub 패턴

- 메시징 모델 중의 하나로 `발행(Publish)` 과 `구독(Subscribe)` 역할로 개념화 한 형태이다.
- 발행자와 구독자는 서로에 대한 정보 없이 `특정 주제(토픽 or 채널)` 를 매개로 수신한다.

## 메시징 미들웨어의 장점

- `비동기`: 통신의 비동기 처리를 한다.
- `낮은 결합도`: 송신자와 수신자가 직접 서로 의존하지 않고, 공통 미들웨어에 의존한다.
- `탄력성`: 구성원들 간에 느슨한 연결이기 때문에 일부 장애가 생겨도 영향이 최소화 된다.

## Redis Pub/Sub 특징

- 메시지가 큐에 저장되지 않는다.
    - 큐에 저장되지 않기 때문에 실행되어 있지 않은 구독자들은 메시지를 받을 수 없다.
    - 즉, 온라인으로 실행되어 있는 구독자들에게만 전송한다는 의미이다.
- Kafka의 컨슈머 그룹과 같은 분산 처리 개념이 없다.
- 메시지 발행시, Push 방식으로 구독자들에게 전송한다.
- 구독자들이 늘어날수록 성능이 저하된다.

## Redis Pub/Sub Usecase

- `실시간으로 빠르게 전송되어야 하는` 메시지인 경우에 사용할 수 있다.
- `현재 접속 중이거나, 로그인 한 클라이언트` 에게 짧고 간단한 메시지를 빠르게 보내고 싶을 때 사용하면 된다.
- 그리고 전송된 메시지를 따로 저장하거나 수신확인이 필요 없을 때 사용하면 된다.
- `마지막으로 100% 전송 보장 하지 않아도 되는 데이터` 를 보낼때 이용하면 괜찮다.
- `메시지 유실을 감내할 수 있는 경우` 에 사용할 수 있다.
- `최대 1회 전송(at-most-once) 패턴` 이 적합한 경우에 사용할 수 있다.
- 구독자들이 다양한 채널을 유동적으로 바꾸면서 한시적으로 구독하는 경우에 사용할 수 있다.
- 주로 `채팅` 기능이나, `푸시 알림` 등에 사용된다.
  - 현재 `App` 에 `로그인` 한 유저에게 푸시 발송하기
  - 배달 `주문/결제완료` 한 유저에게 얼마 후에 도착하는지 푸시 발송하기
- 날씨 정보를 구독한 사람에게 주기적으로 날씨정보를 보내는 경우에 사용할 수 있다.
- 특정한 작업을 반복 수행하는 작업자에게 비동기적으로 작업을 보내 처리하도록 할 수 있다.

## 참고

- [백엔드 개발자를 위한 한 번에 끝내는 대용량 데이터 & 트래픽 처리 초격차 패키지 Online.](https://fastcampus.co.kr/dev_online_bedata)
