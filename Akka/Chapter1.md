# 아카(Akka)에 대하여

저자가 마주한 상황은 프로그램 속도를 단축시키는 것이 필요했다. 이에 따라 가장 쉽게 떠올릴 수 있는 방법은 `시나리오를 분할해 여러 대의 컴퓨터에 분산되어 있는 프로그램에 할당하는 것이다.`
그런데 문제는 프로그램은 `Scale Up` 은 가능해도 `Scale Out` 은 가능하지 않은 방식으로 작성된 것이 문제였다.

- `Scale Up` : 컴퓨터에 CPU 나 메모리를 업그레이드 하는 방식
- `Scale Out` : 컴퓨터를 추가해 병렬 처리하는 방식

그런데 상황에 따라 프로그램의 속도를 개선해야 하는 시점이 빠르게 다가 왔고, 아래와 같은 요구사항을 충족시켜야 했다.

- 컴퓨터 1대 위에서 돌아가는 속도가 6시간보다 빠를 것
- 컴퓨터를 추가해 병렬처리가 가능하게 할 것
- 동작하는 방식이 이해하기 편하고 새로운 시나리오 추가가 쉽도록 코드를 만들 것

첫 번째는 일반적인 `처리율(Throughput)` 에 대한 것이고, 두 번째는 `스케일 아웃(Scale Out)` 에 대한 것이며,
세 번째는 코드의 `모듈화(Modularity)` 에 대한 것이다. 이러한 세가지 요구사항을 충족시키기 위해서 **`아카(Akka)`** 를
선택했다고 한다.

## 처리율(Throughput)

아카를 사용한다고해서 자바 스레드보다 빠르다고 말하면 안된다. `아카도 내부적으로 자바 스레드를 사용` 하고 있기 때문이다.
이러한 커다란 차이가 어디에서 비롯되었는지 이해하려면,`암달의 법칙` 을 생각해보자

> 멀티코어를 사용하는 프로그램의 속도는 프로그램 내부에 존재하는 순차적 부분이 사용하는 시간에 의해서 제한된다.

여러 개의 스레드가 동시에 작업을 수행하더라도 synchronized 블록, 데이터베이스 및 네트워크 API 호출 등을 만날 때, `다른 스레드와 나란히 줄을 서서 순차적으로
작업을 수행해야 하는 경우도 있다.`

`암달의 법칙` 은 프로그램이 낼 수 있는 `속도의 상한이 이런 순차적 코드가 사용하는 시간에 의해서 제한` 된다고 말하는 것이다.

- 순차적 코드의 또 다른 이름 -> `블로킹 콜(Blocking Call)`

`아카(Akka)` 를 사용하면 프로그램 곳곳에 존재하는 순차적 부분, 블로킹 콜을 전부 없애거나 적어도 최소한으로 만드는 것이 가능해진다.
`아카(Akka)`는 넌블로킹 혹은 비동기적 방식으로 탈바꿈시킨다는 점에서 패러다임 전환을 요구한다.

- `아카(Akka)` 를 이용해서 프로그램을 설계한다? -> 블로킹 호출이 일어나는 지점을 `넌블로킹 호출로 전환하는 작업을 수행하는 것` 을 의미한다.
- `블로킹/동기적 호출` 은 낡은 방식이고, `넌블로킹/비동기적 호출` 은 현대적 방식이라는 점을 기억하자. -> `이게 핵심`

## 스케일 아웃(Scale out)

`아카(Akka)` 가 가진 가장 탁월한 장점은 `스케일 아웃을 자동적으로 보장해준다는 점` 이다.

## 모듈화 (Modularity)

`아카(Akka)` 를 동시성 라이브러리 측면에서 접근하는데, `아카(Akka)` 의 `Actor` 모델은 동시성 코드를 지원하기 위한 모델이 아니라
진정한 의미에서 객체지향적인 사고방식을 습득하게 된다.

### `Actor(액터)`

1. 다른 액터에 한정된 개수의 메시지를 보낼 수 있다. (Send a finite number of messages to other actors.)
2. 유한한 개수의 액터를 만들어낼 수 있다. (Create a finite number of new actors.)
3. 다른 액터가 받을 메시지에 수반될 행동을 지정할 수 있다. (Designate the behavior to be used for the next message it receives.)
4. 이러한 모든 일이 동시적으로 일어난다.

`Actor` 는 서로간에 공유하는 자원이 없고, 서로간의 상태를 건드릴 수도 없다. 오직 `Message` 만을 이용해서 정보를 전달할 수 있다.

Multi-core 환경을 효율적으로 활용하기 위해 여러 개의 Thread를 사용하여 구현하는 것이 중요해졌다.
하지만 `Thread 간에 가지는 공유된 자원으로 인해 race condition, deadlock, blocking call 등의 문제가 발생하기 쉽다.` 이를 회피하기 위한 방법의 하나로 `Actor` 모델을
구현한 `아카(Akka)`가 등장했다.

## 차세대 동시성 모델

`7개의 동시성 모델` 이라는 책이 있고, 동시성 코딩과 관련해서 자바의 스레드와 잠금장치 정도만 알고 있는 개발자에게 `Actor` 모델은 모든 개발자가 반드시 알고 넘어가야 하는 차세대 동시성 모델중에 하나이다.

현대 소프트웨어 시스템이 갖춰야 하는 덕목 4가지가 있는데, 다음과 같다.

- `반응성(responsiveness)`
- `탄력성(elasticity)`
- `유연성(resilience)`
- `메세지 중심(event-driven)`
